import{d as B,P as V,Q as x,r as p,R as I,i as S,S as U,k as d,l as A,n as c,w as r,s as g,p as C,T as P,m as y,F as D,A as N,B as L,D as R,L as T}from"./index.6b9f1d7a.js";/* empty css                   */const z=N("\u4E0A\u4F20"),M=["src"],j=B({__name:"upload-image",props:{files:{type:Array,default:()=>[]},accept:{type:String,default:"image/*;*.pdf"},list_type:{type:String,default:"text"},action:{type:String,default:`${V}api/v1/upload_file`},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1}},emits:["refreshImage"],setup(f,{emit:m}){const t=f,h={Authorization:localStorage.getItem("token")||"","x-access-token":x.encrypt("uxdfppium"+Date.now().toString())},n=p(t.files);I(()=>t.files,(s,a)=>{n.value=s});const _=p(""),i=p(!1),v=()=>t.limit&&n.value.length==t.limit?(L.error("\u4E0A\u4F20\u6570\u91CF\u5DF2\u8FBE\u4E0A\u9650"),!1):!0,F=(s,a)=>{const o=a.map(e=>({...e,id:e.id||e.response.id,path:e.path||e.response.path,url:e.url||e.response.url}));m("refreshImage",{file:o,type:"remove"})},b=s=>{t.list_type=="picture-card"&&(_.value=s.url,i.value=!0)},E=(s,a)=>{},k=(s,a,o)=>{const e=o.map(l=>({...l,id:l.id||l.response.data.lists[0].id,name:l.name||l.response.data.lists[0].file_name,url:l.url||l.response.data.lists[0].attachment_url}));m("refreshImage",{file:e,type:"response"})};return(s,a)=>{const o=S,e=R,l=U,w=T;return d(),A(D,null,[c(l,{"file-list":n.value,"onUpdate:file-list":a[0]||(a[0]=u=>n.value=u),action:f.action,headers:h,accept:t.accept,"on-preview":b,"list-type":t.list_type,"on-remove":F,"on-change":E,"on-success":k,limit:t.limit,disabled:t.disabled,"before-upload":v},{default:r(()=>[t.list_type=="picture-card"?(d(),g(o,{key:0},{default:r(()=>[c(C(P))]),_:1})):(d(),g(e,{key:1,type:"primary"},{default:r(()=>[z]),_:1}))]),_:1},8,["file-list","action","accept","list-type","limit","disabled"]),c(w,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=u=>i.value=u)},{default:r(()=>[y("div",null,[y("img",{src:_.value,alt:"Preview Image",style:{width:"100%"}},null,8,M)])]),_:1},8,["modelValue"])],64)}}});export{j as _};
